name: TraqClone

options:
  bundleIdPrefix: net.ras0q
  defaultConfig: Release
  groupSortPosition: bottom
  transitivelyLinkDependencies: false

settingGroups:
  commonSettings:
    base:
      CURRENT_PROJECT_VERSION: '1'
      MARKETING_VERSION: '1.0'
      GENERATE_INFOPLIST_FILE: 'YES'
      INFOPLIST_KEY_UIApplicationSceneManifest_Generation: 'YES'
      INFOPLIST_KEY_UIApplicationSupportsIndirectInputEvents: 'YES'
      INFOPLIST_KEY_UILaunchScreen_Generation: 'YES'

targets:
  TraqClone:
    type: application
    platform: iOS
    sources:
      - TraqClone
      - project.yml
      - README.md
    dependencies:
      - package: Views
    preBuildScripts:
      - name: Install BuildTools
        script: |
          ./scripts/build_tool.sh swiftformat
          ./scripts/build_tool.sh swiftlint
          ./scripts/build_tool.sh xcodegen
        runOnlyWhenInstalling: true
      - name: Run Xcodegen
        script: |
          source .env
          xcodegen generate
        runOnlyWhenInstalling: true
      - name: Run Formatter
        script: ./scripts/run_tool.sh swiftformat .
      - name: Run Linter
        script: ./scripts/run_tool.sh swiftlint .
    settings:
      base:
        DEVELOPMENT_ASSET_PATHS: '"TraqClone/Preview Content"'
      groups:
        - commonSettings

  TraqCloneTests:
    type: bundle.unit-test
    platform: iOS
    sources:
      - TraqCloneTests
    dependencies:
      - target: TraqClone
    settings:
      groups:
        - commonSettings
  TraqCloneUITests:
    platform: iOS
    type: bundle.ui-testing
    sources:
      - TraqCloneUITests
    dependencies:
      - target: TraqClone
    platform: iOS
    settings:
      groups:
        - commonSettings

packages:
  BuildTools:
    path: ./BuildTools/BuildTools # FIXME: cannot place BuildTools in the root of the project
    group: ./BuildTools
  Components:
    path: ./Sources/Components
    group: ./Sources
  Models:
    path: ./Sources/Models
    group: ./Sources
  Repositories:
    path: ./Sources/Repositories
    group: ./Sources
  Views:
    path: ./Sources/Views
    group: ./Sources
